(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){e.exports=a.p+"static/media/planet.480085a3.png"},32:function(e,t,a){e.exports=a.p+"static/media/loading.7daab030.gif"},33:function(e,t,a){e.exports=a(61)},45:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(27),c=a.n(s),i=(a(38),a(40),a(14)),o=a(28),l={user:null,error:null,isLogin:!1},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"connect_google_success":return{user:t.payload,error:null,isLogin:!0};case"connect_google_error":return{user:null,error:t.payload,isLogin:!1};case"logout_success":return{user:null,error:null,isLogin:!1};case"logout_error":return{user:e.user,error:t.payload,isLogin:!1};default:return e}},m=a(18),d=a(4),p={sujets:[]},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"init_sujets":return Object(d.a)({},e,{sujets:[]});case"get_sujets":return Object(d.a)({},e,{sujets:Object(m.a)(e.sujets).concat([t.payload])});default:return e}},h={posts:[],error:"",isLoading:!1},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"init_posts":return Object(d.a)({},e,{posts:[],isLoading:!0});case"get_post_error":return Object(d.a)({},e,{error:t.payload,isLoading:!1});case"get_post_succes":return Object(d.a)({},e,{error:"",posts:Object(m.a)(e.posts).concat([t.payload]),isLoading:!1});case"add_new_post_success":return Object(d.a)({},e,{error:"",isLoading:!1});case"add_new_post_error":return Object(d.a)({},e,{error:t.payload,isLoading:!1});case"set_visa_success":return Object(d.a)({},e,{error:""});case"set_visa_error":return Object(d.a)({},e,{error:t.payload});default:return e}},g={notifications:[],error:""},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"init_notifications":return{notifications:[],error:""};case"get_notifications_error":return Object(d.a)({},e,{error:t.payload});case"get_notifications_success":return Object(d.a)({},e,{error:"",notifications:Object(m.a)(e.notifications).concat([t.payload])});default:return e}},j=Object(i.combineReducers)({auth:u,sujets:f,posts:v,notifications:E}),b=a(12),y=a(30),N=a(64),_=(a(45),a(5)),O=a(6),w=a(8),k=a(7),x=a(9),C=a(66),S=a(62),L=function(){return r.a.createElement("div",{className:"card z-depth-3"},r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"card-title cyan-text text-darken-4 center"},"Interface Web pour le Suivi des Projets Tutor\xe9s."),r.a.createElement("p",{className:"center grey-text text-darken-3"},"Veuillez vous connecter avec votre compte Google, via le bouton Connexion"),r.a.createElement("p",{className:"center grey-text text-darken-3"},"Puis choisir votre sujet, via le bouton Sujets."),r.a.createElement("p",{className:"center grey-text text-darken-3"},"A la fin de votre saisie pensez \xe0 vous deconnecter, via le bouton Deconnexion.")))},D=a(19),A=a.n(D);a(53),a(57);A.a.initializeApp({apiKey:"AIzaSyA0qRYoxSIV35O4RDR-U9Xy3cSp-qIxS_Y",authDomain:"projects-dasboard-app.firebaseapp.com",databaseURL:"https://projects-dasboard-app.firebaseio.com",projectId:"projects-dasboard-app",storageBucket:"projects-dasboard-app.appspot.com",messagingSenderId:"858547302721"});var P=A.a.firestore(),H=A.a.auth(),I=new A.a.auth.GoogleAuthProvider,q=A.a.firestore.FieldValue;P.settings({timestampsInSnapshots:!0});var F=P,z=function(e){function t(){return Object(_.a)(this,t),Object(w.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.props.onInitNotifications(),this.props.onGetNotifications()}},{key:"getDate",value:function(e){return new Date(1e3*e).toLocaleDateString("fr-FR",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}},{key:"render",value:function(){var e=this,t=this.props.notifications;return r.a.createElement("div",{className:"card z-depth-1"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title   center"},"Notifications"),r.a.createElement("ul",{className:"online-users"},t&&t.map(function(t,a){return r.a.createElement("li",{key:t.id,className:"collection-item"},r.a.createElement("div",null,r.a.createElement("span",null,t.user)),r.a.createElement("div",null,r.a.createElement("span",null,t.content)),r.a.createElement("div",null,r.a.createElement("span",{className:"grey-text"},"Post\xe9 le ",e.getDate(t.time.seconds))),r.a.createElement("hr",null))}))))}}]),t}(r.a.Component),G=Object(b.b)(function(e){return{notifications:e.notifications.notifications}},function(e){return{onGetNotifications:function(){return e(function(e){F.collection("notifications").orderBy("time","desc").get().then(function(t){t.forEach(function(t){e({type:"get_notifications_success",payload:t.data()})})}).catch(function(t){e({type:"get_notifications_error",payload:t.message}),console.log(t.message)})})},onInitNotifications:function(){return e(function(e){e({type:"init_notifications",payload:null})})}}})(z),W=function(e){function t(){return Object(_.a)(this,t),Object(w.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12 m7"},r.a.createElement(L,null)),r.a.createElement("div",{className:"col s12 m4 offset-m1"},r.a.createElement(G,null))))}}]),t}(r.a.Component),R=a(65),V=a(31),B=a.n(V),T=a(59),M=function(e){var t=e.sujet;return r.a.createElement("div",{className:"col s12 m5 offset-m1"},r.a.createElement("div",{className:"card card-sujet white z-depth-4"},r.a.createElement("div",{className:"card-image"},r.a.createElement("img",{src:B.a,alt:"decoration"}),r.a.createElement("span",{className:"card-title grey-text text-lighten-4"},t.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement("p",{className:"grey-text text-darken-1"},t.description)),r.a.createElement("div",{className:"card-action"},r.a.createElement(T.a,{to:"/post/"+t.id,className:" btn cyan lighten-1"},"Ouvrir"))))},U=function(e){var t=e.sujets;return r.a.createElement("div",{className:"row"},t&&t.map(function(e,t){return r.a.createElement(M,{sujet:e,key:e.id})}))},J=function(e){function t(){return Object(_.a)(this,t),Object(w.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(O.a)(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.islogin,a=e.sujets;return t?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement(U,{sujets:a})))):r.a.createElement(R.a,{to:"/"})}}]),t}(r.a.Component),Y=Object(b.b)(function(e){return{sujets:e.sujets.sujets,islogin:e.auth.isLogin}},function(e){return{}})(J),K=a(17),X=function(e){function t(){var e,a;Object(_.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(w.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).state={first_name:"",last_name:"",description:"",errors:""},a.onChangeHandler=function(e){a.setState(Object(K.a)({},e.target.id,e.target.value))},a.onPublishHandler=function(e){if(a.validateForm()){a.setState({errors:""});var t={first_name:a.state.first_name.trim(),last_name:a.state.last_name.trim(),description:a.state.description.trim()};a.props.onFormData(t)}},a.onDeleteHandler=function(e){a.setState({description:"",errors:""})},a}return Object(x.a)(t,e),Object(O.a)(t,[{key:"validateForm",value:function(){return""===this.state.first_name.trim()?(this.setState({errors:"Veuillez saisir votre nom de famille !",first_name:""}),!1):""===this.state.last_name.trim()?(this.setState({errors:"Veuillez saisir votre pr\xe9nom !",last_name:""}),!1):""!==this.state.description.trim()||(this.setState({errors:"Veuillez saisir une description !",description:""}),!1)}},{key:"render",value:function(){return r.a.createElement("div",{className:"col s12"},r.a.createElement("div",{className:"white card z-depth-1"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title center grey-text darken-2"},"D\xe9crire bri\xe8vement vos actions de la semaine."),r.a.createElement("form",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s6"},r.a.createElement("input",{className:"validate",value:this.state.first_name,onChange:this.onChangeHandler,id:"first_name",type:"text",required:!0}),r.a.createElement("label",{htmlFor:"first_name"},"Nom")),r.a.createElement("div",{className:"input-field col s6"},r.a.createElement("input",{className:"validate",value:this.state.last_name,onChange:this.onChangeHandler,id:"last_name",type:"text",required:!0}),r.a.createElement("label",{htmlFor:"last_name"},"Pr\xe9nom"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"material-icons prefix"},"mode_edit"),r.a.createElement("textarea",{id:"description",className:"materialize-textarea validate",placeholder:"Vos actions ...",value:this.state.description,onChange:this.onChangeHandler,required:!0}),r.a.createElement("label",{htmlFor:"description"},"Descriptions"))))),r.a.createElement("div",{className:"card-action"},r.a.createElement("a",{className:"btn-floating waves-effect waves-light btn",onClick:this.onPublishHandler},r.a.createElement("i",{className:"material-icons"},"publish")),r.a.createElement("a",{className:"btn-floating waves-effect waves-light red btn",onClick:this.onDeleteHandler},r.a.createElement("i",{className:"material-icons"},"delete")),r.a.createElement("span",{className:"red-text darken-4"},this.state.errors))))}}]),t}(r.a.Component);var $=function(e){var t,a=e.post,n=e.isAdmin;return r.a.createElement("div",{className:"col s12 m4"},r.a.createElement("div",{className:"card white z-depth-2"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title grey-text darken-2"},r.a.createElement("img",{className:"avatar-image",src:a.author_image,alt:"avatar"}),a.first_name," ",a.last_name),r.a.createElement("p",null,a.description),r.a.createElement("small",{className:"grey-text darken-1"},"Post\xe9 le ",(t=a.create_at.seconds,new Date(1e3*t).toLocaleDateString("fr-FR",{weekday:"short",year:"numeric",month:"short",day:"numeric"})),function(e){if(!e)return r.a.createElement("span",{className:"new badge red"})}(a.visa)),r.a.createElement("hr",null),r.a.createElement("p",{className:"red-text"},a.remarques)),r.a.createElement("div",{className:"card-action"},function(e,t){if(e)return r.a.createElement(T.a,{to:"/visa/"+t,className:"waves-effect waves-light btn"},r.a.createElement("i",{className:"material-icons"},"edit"))}(n,a.id))))},Q=function(e){var t=e.posts,a=e.isAdmin;return r.a.createElement("div",{className:"row"},t&&t.map(function(e,t){return r.a.createElement($,{isAdmin:a,post:e,key:e.id})}))},Z=a(32),ee=a.n(Z),te=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(k.a)(t).call(this,e))).onFormData=function(e){if(a.setState({toggle:!1}),e){var t=Object(d.a)({},e,{sujet_name:a.state.sujet_name,sujet_id:a.state.sujet_id});a.props.onCreateNewPost(t)}},a.toggleHandler=function(e){a.setState({toggle:!a.state.toggle})},a.state={toggle:!1,sujet_name:e.sujet.name,sujet_id:e.sujet.id},a}return Object(x.a)(t,e),Object(O.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.props.onGetPostBySujetId(this.state.sujet_id),setTimeout(function(){e.setState({})},5e3)}},{key:"afficheTitre",value:function(e,t){if(!t)return e?r.a.createElement("h4",{className:"center grey-text darken-2"},"Projet Tutor\xe9 ",e.name,r.a.createElement("a",{onClick:this.toggleHandler,className:"btn-floating btn-large waves-effect waves-light"},r.a.createElement("i",{className:"material-icons"},"edit"))):r.a.createElement("h4",null,"Loading...")}},{key:"afficheLoading",value:function(e){if(e)return r.a.createElement("div",{className:"center"},r.a.createElement("img",{src:ee.a,alt:"loading"}))}},{key:"afficheForm",value:function(e,t){if(!t)return e?r.a.createElement(X,{onFormData:this.onFormData}):null}},{key:"render",value:function(){var e=this.props,t=e.sujet,a=e.isAdmin,n=e.isLoading;return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},this.afficheLoading(n)),r.a.createElement("div",{className:"row"},this.afficheTitre(t,n)),r.a.createElement("div",{className:"row"},this.afficheForm(this.state.toggle,n)),r.a.createElement("div",null,n?"":r.a.createElement(Q,{isAdmin:a,posts:this.props.posts})))}}]),t}(r.a.Component),ae=Object(b.b)(function(e){return{posts:e.posts.posts,isLoading:e.posts.isLoading}},function(e){return{onGetPostBySujetId:function(t){return e((a=t,function(e){F.collection("posts").where("sujet_id","==",a).orderBy("create_at","desc").get().then(function(t){t.forEach(function(t){e({type:"get_post_succes",payload:t.data()})})}).catch(function(t){e({type:"get_post_error",payload:t.message}),console.log(t.message)})}));var a}}})(te),ne=function(e){function t(){var e,a;Object(_.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(w.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).onCreateNewPost=function(e){if(e){var t=a.props.user,n=t.id,r=t.image,s=Object(d.a)({},e,{author_id:n,author_image:r,visa:!1,remarques:""});a.props.onAddNewPost(s)}},a}return Object(x.a)(t,e),Object(O.a)(t,[{key:"componentWillMount",value:function(){this.props.onInitPosts()}},{key:"render",value:function(){var e=this.props,t=e.islogin,a=e.sujet,n=e.user;return t?r.a.createElement("div",{className:"fluid"},r.a.createElement(ae,{isAdmin:n.isAdmin,sujet:a,onCreateNewPost:this.onCreateNewPost})):r.a.createElement(R.a,{to:"/"})}}]),t}(r.a.Component),re=Object(b.b)(function(e,t){var a=t.match.params.id,n=e.sujets.sujets.filter(function(e){return e.id===a}),r={};return r=n.length>0?n[0]:{},{islogin:e.auth.isLogin,id:a,sujet:r,user:e.auth.user}},function(e){return{onAddNewPost:function(t){return e(function(e){return function(t){var a=F.collection("posts").doc();e.create_at=q.serverTimestamp(),e.id=a.id,F.collection("posts").doc(a.id).set(e).then(function(e){t({type:"add_new_post_success"})}).catch(function(e){t({type:"add_new_post_error",payload:e.message}),console.log(e)})}}(t))},onInitPosts:function(){return e(function(e){e({type:"init_posts",payload:null})})}}})(ne),se=function(e){function t(){var e,a;Object(_.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(w.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).state={remarques:""},a.onPublishHandler=function(e){var t=Object(d.a)({},a.state,{post_id:a.props.match.params.id});a.props.onSetVisa(t),a.props.history.push("/sujets")},a.onChangeHandler=function(e){a.setState(Object(K.a)({},e.target.id,e.target.value))},a.onDeleteHandler=function(e){a.setState({remarques:""})},a}return Object(x.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props.match.params.id;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("div",{className:"white card z-depth-1"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title center grey-text darken-2"},"Post Id: ",e),r.a.createElement("form",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"material-icons prefix"},"mode_edit"),r.a.createElement("textarea",{id:"remarques",value:this.state.remarques,onChange:this.onChangeHandler,className:"materialize-textarea validate",required:!0}),r.a.createElement("label",{htmlFor:"remarques"},"Remarques"))))),r.a.createElement("div",{className:"card-action"},r.a.createElement("a",{className:"btn-floating waves-effect waves-light btn",onClick:this.onPublishHandler},r.a.createElement("i",{className:"material-icons"},"publish")),r.a.createElement("a",{className:"btn-floating waves-effect waves-light red btn",onClick:this.onDeleteHandler},r.a.createElement("i",{className:"material-icons"},"delete")))))))}}]),t}(r.a.Component),ce=Object(b.b)(null,function(e){return{onSetVisa:function(t){return e(function(e){return function(t){F.collection("posts").doc(e.post_id).update({visa:!0,remarques:e.remarques}).then(function(e){t({type:"set_visa_success",payload:null})}).catch(function(e){t({type:"set_visa_error",payload:e.message}),console.log(e.message)})}}(t))}}})(se),ie=function(){return r.a.createElement(C.a,null,r.a.createElement(S.a,{exact:!0,path:"/",component:W}),r.a.createElement(S.a,{path:"/sujets",component:Y}),r.a.createElement(S.a,{path:"/post/:id",component:re}),r.a.createElement(S.a,{path:"/visa/:id",component:ce}))},oe=a(63),le=function(e){function t(){var e,a;Object(_.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(w.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).logOutHandle=function(e){a.props.onLogOut()},a.connectGoogleHandler=function(e){a.props.onInitSujets(),a.props.onGetSujets(),a.props.onConnectWithGoogle()},a}return Object(x.a)(t,e),Object(O.a)(t,[{key:"afficheAvatar",value:function(e){return e?r.a.createElement("div",null,r.a.createElement("div",{className:"avatar-layout"},r.a.createElement("div",null,r.a.createElement("img",{className:"avatar-image",src:e.image,alt:"avatar"})),r.a.createElement("div",{className:"avatar-name"},r.a.createElement("span",null,e.name)))):null}},{key:"afficheConnexion",value:function(e){return e?r.a.createElement("a",{onClick:this.logOutHandle},"D\xe9connexion"):r.a.createElement("a",{onClick:this.connectGoogleHandler},"Connexion")}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.login;return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper cyan  darken-3"},r.a.createElement(oe.a,{to:"",className:"brand-logo left"},r.a.createElement("i",{className:"material-icons"},"home")),r.a.createElement("ul",{id:"nav-mobile",className:"right"},r.a.createElement("li",null,this.afficheConnexion(a)),r.a.createElement("li",null,r.a.createElement(oe.a,{to:"/sujets"},"Sujets")),r.a.createElement("li",null,this.afficheAvatar(t)))))}}]),t}(r.a.Component),ue=Object(b.b)(function(e){return{login:e.auth.isLogin,user:e.auth.user}},function(e){return{onLogOut:function(){return e(function(e){H.signOut().then(function(t){e({type:"logout_success",payload:null})}).catch(function(t){e({type:"logout_error",payload:t.message})})})},onConnectWithGoogle:function(){return e(function(e){H.signInWithPopup(I).then(function(t){var a={};if(t.user.uid)return"Adelino DeCarvalho"===(a={id:t.user.uid,name:t.user.displayName,image:t.user.photoURL,isAdmin:!1,create_at:new Date}).name&&(a.isAdmin=!0),F.collection("users").doc(t.user.uid).set(a).then(function(){console.log("user created"),e({type:"connect_google_success",payload:a})}).catch(function(t){console.log(t.message),e({type:"connect_google_error",payload:t.message})})})})},onGetSujets:function(){return e(function(e){F.collection("sujets").orderBy("name").get().then(function(t){t.forEach(function(t){e({type:"get_sujets",payload:t.data()})})}).catch(function(e){console.log(e.message)})})},onInitSujets:function(){return e(function(e){e({type:"init_sujets",payload:null})})}}})(le),me=function(e){return r.a.createElement("footer",null,r.a.createElement("div",{className:"footer-copyright"},r.a.createElement("div",{className:"container grey-text text-darken-3"},r.a.createElement("small",null,"\xa9 2019 A.DeCarvalho"))))},de=function(e){function t(){return Object(_.a)(this,t),Object(w.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue,null),r.a.createElement("main",{id:"app"},r.a.createElement(ie,null)),r.a.createElement(me,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pe=Object(i.createStore)(j,Object(y.composeWithDevTools)(Object(i.applyMiddleware)(o.a)));c.a.render(r.a.createElement(b.a,{store:pe},r.a.createElement(N.a,null,r.a.createElement(de,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[33,2,1]]]);
//# sourceMappingURL=main.d9bf4b0d.chunk.js.map